Code from Phase1 to Phase3
